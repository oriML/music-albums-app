<mat-toolbar color="primary">
  <button mat-icon-button (click)="goBack()">
    <mat-icon>arrow_back</mat-icon>
  </button>
  <span>Album Details</span>
</mat-toolbar>

<div class="detail-container">
  @if (isLoading) {
  <div class="loading-spinner">
    <mat-spinner></mat-spinner>
  </div>
  }
  @if (error) {
  <div class="error-message">
    <mat-card color="warn">{{ error }}</mat-card>
    <button mat-raised-button color="primary" (click)="goBack()">Go Back</button>
  </div>
  }
  @if (album) {

  <mat-card class="album-detail-card">
    <div class="top-section">
      <img [src]="album.images[0]?.url" alt="{{ album.name }}" class="cover-image">
      <div class="info-section">
        <h2>{{ album.name }}</h2>
        <h3>
          @for (artist of album.artists; track artist.id) {
          <a [href]="'https://open.spotify.com/artist/' + artist.id" target="_blank">{{ artist.name }}</a>@if (!$last) {<span>, </span>}
          }
        </h3>
        <p>Release Date: {{ album.release_date }}</p>
        <p>Total Tracks: {{ album.total_tracks }}</p>
        <a mat-raised-button color="accent" [href]="album.external_url" target="_blank">
          <mat-icon>open_in_new</mat-icon> Listen on Spotify
        </a>
        <button mat-icon-button (click)="toggleFavorite(album)">
          <mat-icon [color]="favoritesService.isFavorite(album.id) ? 'warn' : ''">favorite</mat-icon>
        </button>
      </div>
    </div>

    <mat-card-content>
      <h3>Tracks</h3>
      <mat-list>
        @for (track of album.tracks; track track.id) {
        <mat-list-item>
          <span matListItemTitle>{{ track.track_number }}. {{ track.name }}</span>
          <span matListItemLine>{{ formatDuration(track.duration_ms) }}</span>
        </mat-list-item>
        }
      </mat-list>
    </mat-card-content>
  </mat-card>
  }
  @if (!isLoading && !error && !album) {
  <div class="no-album-found">
    <p>Album not found or invalid ID.</p>
    <button mat-raised-button color="primary" (click)="goBack()">Go Back</button>
  </div>
  }
</div>